<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Archive Viewer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#020617;
  --border:#334155;
  --text:#e5e7eb;
  --accent:#38bdf8;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui, sans-serif;
}

/* HEADER */
header{
  text-align:center;
  padding:1.5rem 1rem;
}

.welcome-text {
  background: linear-gradient(90deg, #22d3ee, #a78bfa, #f472b6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-size: 1.2rem;
  font-weight: 500;
  margin-bottom: 1rem;
}

.contact-link {
  text-align: center;
  padding: 1.5rem;
  font-size: 1.3rem;
  background: linear-gradient(90deg, #22d3ee, #a78bfa, #f472b6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 600;
  cursor: pointer;
}

.contact-link:hover {
  text-decoration: underline;
}

/* MAIN EMBED */
.embed-wrap{
  position:relative;
  width:100vw;
  margin-left:calc(50% - 50vw);
}

.embed-wrap iframe{
  width:100vw;
  height:420px;
  border:none;
}

/* FULLSCREEN ICON */
.fullscreen{
  position:absolute;
  top:14px;
  right:18px;
  font-size:1.2rem;
  cursor:pointer;
  opacity:.75;
}
.fullscreen:hover{opacity:1}

/* CONTENT */
.content-inner{
  max-width:900px;
  margin:auto;
  padding:1.5rem;
}

.title{
  font-size:1.6rem;
  font-weight:600;
  margin-bottom:.8rem;
}

.meta{
  line-height:1.7;
  margin-bottom:1.2rem;
}

.actions{
  display:flex;
  gap:1rem;
  align-items:center;
  flex-wrap: wrap;
}

.button{
  padding:.6rem 1.3rem;
  background:var(--accent);
  color:#020617;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
  text-decoration: none;
  display: inline-block;
  margin: 0.3rem;
}

.share{
  cursor:pointer;
  font-size:1.3rem;
  opacity:.75;
}
.share:hover{opacity:1}

/* FULLSCREEN OVERLAY */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(2,6,23,.95);
  display:none;
  z-index:9999;
}

#overlay iframe{
  width:100vw;
  height:100vh;
  border:none;
}

.close{
  position:absolute;
  top:14px;
  right:20px;
  font-size:1.6rem;
  cursor:pointer;
  z-index:10000;
}

/* METADATA DISPLAY */
.metadata-section {
  background: rgba(56, 189, 248, 0.1);
  border-radius: 12px;
  padding: 1.5rem;
  margin: 1.5rem 0;
}

.metadata-section h3 {
  margin-top: 0;
  color: var(--accent);
  border-bottom: 1px solid var(--border);
  padding-bottom: 0.5rem;
}

.metadata-item {
  margin: 0.8rem 0;
}

.metadata-label {
  font-weight: bold;
  color: var(--accent);
}

.metadata-value {
  margin-left: 0.5rem;
}

.links-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin-top: 1rem;
}
</style>
</head>

<body>

<header>
  <div class="welcome-text">Welcome — explore content designed to be simple, fast, and meaningful.</div>
</header>

<main id="content"></main>

<div class="contact-link" onclick="window.open('https://more-webs.github.io/yan-1-website-weather-page/', '_blank')">
  For advertisements or web & app development, contact us (click)
</div>

<!-- FULLSCREEN -->
<div id="overlay">
  <div class="close" onclick="exitFullscreen()">✕</div>
  <iframe id="fsFrame"></iframe>
</div>

<script>
let data=[], index=0;

/* FETCH data4.json */
fetch('data4.json')
  .then(r=>r.json())
  .then(j=>{
    data=j;
    render();
  });

function getEmbed(link){
  return link?.includes('archive.org')
    ? 'https://archive.org/embed/' + link.split('/details/')[1]
    : '';
}

// Function to fetch metadata from Archive.org
async function fetchMetadata(identifier) {
  try {
    const response = await fetch(`https://archive.org/metadata/${identifier}`);
    const metadata = await response.json();
    
    // Extract relevant information
    const title = metadata.metadata?.title || 'N/A';
    const description = metadata.metadata?.description || 'N/A';
    const tags = metadata.metadata?.subject || [];
    const phone = metadata.metadata?.phone || 'N/A';
    const email = metadata.metadata?.email || 'N/A';
    const link1 = metadata.metadata?.link1 || null;
    const link2 = metadata.metadata?.link2 || null;
    const link3 = metadata.metadata?.link3 || null;
    
    // Format tags as a comma-separated string
    const formattedTags = Array.isArray(tags) ? tags.join(', ') : tags;
    
    return {
      title,
      description,
      tags: formattedTags,
      phone,
      email,
      link1,
      link2,
      link3
    };
  } catch (error) {
    console.error('Error fetching metadata:', error);
    return {
      title: 'N/A',
      description: 'N/A',
      tags: 'N/A',
      phone: 'N/A',
      email: 'N/A',
      link1: null,
      link2: null,
      link3: null
    };
  }
}

async function render(){
  const i=data[index];
  const e=getEmbed(i.archive_link);
  
  // Extract identifier from archive_link
  const identifier = i.archive_link.split('/details/')[1];
  
  // Fetch metadata
  const metadata = await fetchMetadata(identifier);

  content.innerHTML=`
    ${e?`
    <div class="embed-wrap">
      <span class="fullscreen" onclick="nativeFullscreen()">⛶</span>
      <iframe id="embedFrame" src="${e}"></iframe>
    </div>`:''}

    <div class="content-inner">
      <div class="metadata-section">
        <h3>Item Information</h3>
        ${metadata.title !== 'N/A' ? `<div class="metadata-item"><span class="metadata-label">Title:</span><span class="metadata-value">${metadata.title}</span></div>` : ''}
        ${metadata.description !== 'N/A' ? `<div class="metadata-item"><span class="metadata-label">Description:</span><span class="metadata-value">${metadata.description}</span></div>` : ''}
        ${metadata.tags !== 'N/A' && metadata.tags ? `<div class="metadata-item"><span class="metadata-label">Tags:</span><span class="metadata-value">${metadata.tags}</span></div>` : ''}
        ${metadata.phone !== 'N/A' ? `<div class="metadata-item"><span class="metadata-label">Phone:</span><span class="metadata-value">${metadata.phone}</span></div>` : ''}
        ${metadata.email !== 'N/A' ? `<div class="metadata-item"><span class="metadata-label">Email:</span><span class="metadata-value">${metadata.email}</span></div>` : ''}
        
        ${(metadata.link1 || metadata.link2 || metadata.link3) ? 
          `<div class="metadata-item">
            <span class="metadata-label">Links:</span>
            <div class="links-container">
              ${metadata.link1 ? `<a href="${metadata.link1}" target="_blank" class="button">Link 1</a>` : ''}
              ${metadata.link2 ? `<a href="${metadata.link2}" target="_blank" class="button">Link 2</a>` : ''}
              ${metadata.link3 ? `<a href="${metadata.link3}" target="_blank" class="button">Link 3</a>` : ''}
            </div>
          </div>` : ''}
      </div>
    </div>
  `;
}

/* FULLSCREEN */
function nativeFullscreen(){
  document.getElementById('embedFrame')?.requestFullscreen();
}
function exitFullscreen(){
  document.exitFullscreen?.();
}

/* SHARE */
function share(url,title){
  navigator.share
    ? navigator.share({title,url})
    : navigator.clipboard.writeText(url)&&alert('Link copied');
}

/* ESC KEY */
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){
    exitFullscreen();
  }
});
</script>

</body>
</html>
